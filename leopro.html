<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Apple Of Fortune</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Cinzel:wght@400;700;900&family=Pacifico&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #6a5acd;
      --primary-light: #8a2be2;
      --accent: #ffd700;
      --telegram: #0088cc;
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #000;
      color: #fff;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      overflow-x: hidden;
      min-height: 100vh;
      transition: all 0.3s ease;
    }
    .mobile-frame {
      max-width: 400px;
      margin: 0 auto;
      min-height: 100vh;
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
    }
    .background-main, .background-image, .background-overlay, .background-game {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%; z-index: 1;
    }
    .background-main {
      background: linear-gradient(135deg, rgba(12, 10, 6, 0.7) 0%, rgba(26, 20, 13, 0.7) 50%, rgba(12, 10, 6, 0.7) 100%);
    }
    .background-image {
      background-image: url('https://f.top4top.io/p_3582p50um1.jpg');
      background-size: cover;
      background-position: center;
      opacity: 0.95;
    }
    .background-overlay {
      background: rgba(0, 0, 0, 0.5);
    }
    .background-game {
      background-image: url('https://a.top4top.io/p_3582psttc1.jpg');
      background-size: cover;
      background-position: center;
      display: none;
    }
    .overlay {
      min-height: 100vh;
      padding: 15px;
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 2;
    }
    .page {
      display: none;
      animation: fadeIn 0.5s ease-out;
      flex: 1;
    }
    .active {
      display: flex;
      flex-direction: column;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* === نافذة التفعيل === */
    .activation-modal {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      animation: fadeIn 0.3s ease;
    }
    .activation-content {
      background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
      border: 3px solid var(--primary);
      border-radius: 16px;
      padding: 25px;
      width: 90%;
      max-width: 350px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
      animation: scaleIn 0.4s ease;
      position: relative;
      text-align: center;
    }
    @keyframes scaleIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .activation-text {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.4rem;
      font-weight: 800;
      color: var(--accent);
      text-shadow: 0 0 8px rgba(255, 215, 0, 0.8), 0 0 16px rgba(255, 215, 0, 0.6);
      letter-spacing: 1px;
      animation: blinkText 2s infinite;
    }
    @keyframes blinkText {
      0% { opacity: 1; }
      50% { opacity: 0.6; }
      100% { opacity: 1; }
    }

    /* === نص LEO ALGORITHMS === */
    .algorithms-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.3rem;
      font-weight: 800;
      color: var(--accent);
      text-shadow: 0 0 8px rgba(255, 215, 0, 0.8), 0 0 16px rgba(255, 215, 0, 0.6);
      letter-spacing: 1px;
      animation: blinkText 2s infinite;
      text-align: center;
      margin-bottom: 10px;
    }

    /* === باقي الأنماط كما في الكود الأصلي === */
    .logo { font-size: 1.8rem; font-weight: 800; color: #fff; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); letter-spacing: 1px; }
    .logo span { color: var(--primary); }
    .game-title { color: var(--primary); font-size: 2.2rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); margin: 10px 0 30px; font-weight: 700; text-align: center; line-height: 1.3; }
    .form-container { width: 100%; max-width: 400px; margin: 0 auto; }
    #pageRegistration .logo-container { display: none; }
    .input-group { margin-bottom: 20px; }
    .input-label { display: block; color: var(--primary); font-weight: 600; margin-bottom: 8px; font-size: 1rem; text-align: right; }
    .input-field, .password-field, .activation-input-field {
      width: 100%;
      padding: 15px 20px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid var(--primary);
      border-radius: 12px;
      font-size: 1.1rem;
      color: #fff;
      transition: all 0.3s;
      box-shadow: 0 4px 10px rgba(106, 90, 205, 0.3);
    }
    .input-field:focus, .password-field:focus, .activation-input-field:focus {
      outline: none;
      background: rgba(255, 255, 255, 0.15);
      border-color: var(--primary-light);
      box-shadow: 0 4px 15px rgba(138, 43, 226, 0.5);
    }
    .password-group { display: flex; gap: 10px; align-items: center; margin-bottom: 20px; }
    .activate-btn, .ok-btn, .btn, .control-btn, .warning-btn, .time-expired-btn {
      padding: 12px 20px;
      background: linear-gradient(to right, var(--primary), var(--primary-light));
      color: #fff;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(106, 90, 205, 0.4);
      white-space: nowrap;
    }
    .activate-btn:hover, .ok-btn:hover, .btn:hover, .control-btn:hover, .warning-btn:hover, .time-expired-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(106, 90, 205, 0.6);
      background: linear-gradient(to right, var(--primary-light), var(--primary));
    }
    .ok-btn { width: 40%; margin: 20px auto 0; display: block; }
    .btn { width: 100%; margin-top: 20px; padding: 16px; font-size: 1.2rem; }

    /* === نقل أيقونة التعليمات إلى الأسفل === */
    .instructions-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 20px auto 30px;
      width: 45px;
      height: 45px;
      background: linear-gradient(to right, var(--primary), var(--primary-light));
      border-radius: 50%;
      color: white;
      font-size: 1.3rem;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(106, 90, 205, 0.5);
      transition: all 0.3s;
    }
    .instructions-icon:hover { transform: scale(1.1); box-shadow: 0 6px 20px rgba(106, 90, 205, 0.7); }

    /* === صفحة اللعبة: تعديل التخطيط === */
    #pageGame .overlay {
      justify-content: space-between;
      padding: 10px;
    }
    .game-top-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 10px;
    }
    .user-id-display {
      background: rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(106, 90, 205, 0.7);
      border-radius: 8px;
      padding: 6px 10px;
      min-width: 120px;
      height: 40px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      margin-bottom: 10px;
    }
    .user-id-value {
      color: var(--accent);
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      font-weight: 700;
    }
    .user-id-label {
      font-size: 0.6rem;
      color: #fff;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 2px;
    }
    .top-info-boxes {
      display: flex;
      justify-content: center;
      gap: 15px;
      padding: 10px 0;
      margin-bottom: 10px;
    }
    .top-info-box {
      background: rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(106, 90, 205, 0.7);
      border-radius: 8px;
      padding: 8px 12px;
      min-width: 140px;
      height: 50px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    .top-info-value {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--primary);
      text-shadow: 0 0 10px rgba(106, 90, 205, 0.7);
      letter-spacing: 1px;
      margin-bottom: 2px;
    }
    .top-info-label {
      font-size: 0.7rem;
      color: #fff;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* === الحاوية الرئيسية في المنتصف === */
    .game-middle-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      margin: 10px 0;
    }
    .images-rectangle {
      background: rgba(30, 30, 30, 0.9);
      border: 2px solid var(--primary);
      border-radius: 16px;
      padding: 10px;
      width: 100%;
      max-width: 360px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
    }
    .images-grid-container {
      display: flex;
      align-items: center;
      flex-direction: row;
      gap: 10px;
    }
    .multipliers {
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 250px;
      margin-right: 8px;
      padding: 4px 0;
    }
    .multiplier {
      color: var(--accent);
      font-size: 0.85rem;
      font-weight: 700;
      text-shadow: 0 0 5px rgba(255, 215, 0, 0.7);
      font-family: 'Orbitron', sans-serif;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid var(--primary);
      border-radius: 6px;
      padding: 0 8px;
      margin: 8px 0;
      box-shadow: 0 0 8px rgba(106, 90, 205, 0.5);
    }
    .images-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      grid-template-rows: repeat(6, 1fr);
      gap: 6px;
      flex: 1;
    }
    .image-cell {
      background: rgba(106, 90, 205, 0.15);
      border: 2px solid var(--primary);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      transition: all 0.3s;
      position: relative;
    }
    .image-cell.revealed {
      border-color: var(--accent);
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
    }
    .image-cell img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: none;
      border-radius: 50%;
    }
    .image-cell.revealed img {
      display: block;
      animation: revealImage 0.5s ease-out;
    }
    @keyframes revealImage {
      0% { transform: scale(0.5); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    /* === الأزرار والكود في الأسفل === */
    .game-bottom-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
    }
    .game-controls-external {
      display: flex;
      gap: 12px;
      margin: 15px auto 10px;
      width: 90%;
      max-width: 400px;
    }
    .control-btn {
      flex: 1;
      padding: 12px;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 1rem;
    }
    .start-btn {
      background: linear-gradient(to right, var(--primary), var(--primary-light));
      color: #fff;
    }
    .restart-btn {
      background: rgba(255, 255, 255, 0.1);
      color: var(--primary);
      border: 2px solid var(--primary);
    }
    .code-display {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.4rem;
      font-weight: 800;
      color: var(--accent);
      text-shadow: 0 0 8px rgba(255, 215, 0, 0.8), 0 0 16px rgba(255, 215, 0, 0.6);
      letter-spacing: 2px;
      animation: codePulse 1.5s infinite alternate;
      text-align: center;
      margin: 10px auto 15px;
      padding: 6px 12px;
      background: rgba(0, 0, 0, 0.6);
      border-radius: 8px;
      border: 1px solid rgba(255, 215, 0, 0.4);
      max-width: 280px;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
    }
    @keyframes codePulse {
      0% { text-shadow: 0 0 8px rgba(255, 215, 0, 0.8); }
      100% { text-shadow: 0 0 16px rgba(255, 215, 0, 1), 0 0 24px rgba(255, 215, 0, 0.8); }
    }
    .telegram-link {
      display: flex;
      justify-content: center;
      margin-bottom: 10px;
    }
    .telegram-icon {
      width: 36px;
      height: 36px;
      background: var(--telegram);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      text-decoration: none;
      box-shadow: 0 4px 10px rgba(0, 136, 204, 0.5);
      transition: all 0.3s;
    }
    .telegram-icon:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 15px rgba(0, 136, 204, 0.7);
    }

    /* === باقي الأنماط (التعليمات، التفعيل، الانتظار، إلخ) كما هي === */
    .instructions-modal, .warning-modal, .time-expired-modal {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
      animation: fadeIn 0.3s ease;
    }
    .instructions-content, .warning-content, .time-expired-content {
      background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
      border: 3px solid var(--primary);
      border-radius: 16px;
      padding: 25px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
      animation: scaleIn 0.4s ease;
      position: relative;
    }
    .instructions-close {
      position: absolute;
      top: 15px;
      left: 15px;
      background: none;
      border: none;
      color: var(--primary);
      font-size: 1.5rem;
      cursor: pointer;
    }
    .instructions-close:hover {
      transform: scale(1.1);
      color: var(--primary-light);
    }
    .instructions {
      background: rgba(30, 30, 30, 0.95);
      border: 2px solid var(--primary);
      border-radius: 16px;
      padding: 18px;
      margin: 0 auto;
      max-width: 450px;
      font-family: 'Cinzel', serif;
      font-size: 0.95rem;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
    }
    .instructions h3 {
      color: var(--primary);
      text-align: center;
      margin-bottom: 15px;
      font-size: 1.3rem;
      font-weight: 800;
      text-shadow: 0 0 8px rgba(106, 90, 205, 0.5);
    }
    .instructions ul { padding-right: 15px; }
    .instructions li {
      margin-bottom: 12px;
      line-height: 1.5;
      display: flex;
      align-items: flex-start;
      gap: 10px;
      font-size: 0.9rem;
      font-weight: 700;
      color: #f0f0f0;
    }
    .instructions .warning-icon {
      color: var(--primary);
      font-size: 1.1rem;
      min-width: 20px;
      text-shadow: 0 0 5px rgba(106, 90, 205, 0.7);
    }
    .instructions-signature {
      margin-top: 15px;
      text-align: center;
      font-family: 'Cinzel', serif;
      font-size: 1.1rem;
      font-weight: 800;
      color: var(--primary);
      text-shadow: 0 0 10px rgba(106, 90, 205, 0.7);
      letter-spacing: 1px;
    }

    .waiting-page {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      min-height: calc(100vh - 100px);
      padding: 20px;
      text-align: center;
    }
    .waiting-container {
      background: rgba(30, 30, 30, 0.9);
      border: 2px solid var(--primary);
      border-radius: 16px;
      padding: 15px 12px;
      width: 85%;
      max-width: 350px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
      position: relative;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.8; }
      100% { opacity: 1; }
    }
    .waiting-title {
      font-size: 1.6rem;
      color: var(--primary);
      margin-bottom: 12px;
      font-weight: 700;
      text-shadow: 0 0 15px rgba(106, 90, 205, 0.7);
    }
    .time-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 12px 0;
    }
    .time-display {
      font-size: 2.5rem;
      color: var(--primary);
      font-weight: 800;
      margin: 8px 0;
      text-shadow: 0 0 15px rgba(106, 90, 205, 0.7);
      font-family: 'Orbitron', sans-serif;
      background: rgba(0, 0, 0, 0.5);
      padding: 10px 20px;
      border-radius: 12px;
      border: 2px solid var(--primary);
      box-shadow: 0 0 20px rgba(106, 90, 205, 0.5);
      letter-spacing: 3px;
    }
    .time-label {
      font-size: 1.1rem;
      color: var(--primary);
      margin-top: 5px;
      font-weight: 700;
      text-shadow: 0 0 8px rgba(106, 90, 205, 0.5);
    }
    .steps-container {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
      position: relative;
    }
    .step {
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 2;
      flex: 1;
    }
    .step-icon {
      width: 35px;
      height: 35px;
      background: rgba(106, 90, 205, 0.3);
      border: 2px solid var(--primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 5px;
      font-size: 1rem;
      color: var(--primary);
    }
    .step.active .step-icon {
      background: rgba(106, 90, 205, 0.6);
      color: #fff;
      box-shadow: 0 0 15px rgba(106, 90, 205, 0.7);
      transform: scale(1.1);
    }
    .step-text {
      font-size: 0.7rem;
      color: #aaa;
      text-align: center;
      line-height: 1.3;
    }
    .step.active .step-text {
      color: var(--primary);
      font-weight: 600;
    }
    .steps-line {
      position: absolute;
      top: 17px;
      left: 10%;
      right: 10%;
      height: 2px;
      background: rgba(106, 90, 205, 0.3);
      z-index: 1;
    }
    .progress-container {
      width: 90%;
      height: 8px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      margin: 12px auto 15px;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      width: 0;
      background: linear-gradient(to right, var(--primary), var(--primary-light));
      border-radius: 4px;
      transition: width 0.3s;
    }
    .melbet-warning {
      background: rgba(106, 90, 205, 0.15);
      border: 1px solid var(--primary);
      border-radius: 10px;
      padding: 10px 12px;
      margin: 12px auto;
      max-width: 340px;
      text-align: center;
      animation: warningPulse 2s infinite;
      box-shadow: 0 0 10px rgba(106, 90, 205, 0.3);
    }
    @keyframes warningPulse {
      0% { box-shadow: 0 0 5px rgba(106, 90, 205, 0.3); transform: scale(1); }
      100% { box-shadow: 0 0 15px rgba(106, 90, 205, 0.6); transform: scale(1.02); }
    }
    .melbet-text {
      color: var(--primary);
      font-size: 0.85rem;
      font-weight: 700;
      line-height: 1.4;
      text-shadow: 0 0 5px rgba(106, 90, 205, 0.5);
    }
    .waiting-message {
      font-size: 0.9rem;
      color: var(--primary);
      margin-top: 12px;
      line-height: 1.5;
      padding: 10px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 6px;
      border: 1px solid rgba(106, 90, 205, 0.5);
    }

    .language-switcher {
      position: absolute;
      top: 15px;
      right: 15px;
      cursor: pointer;
      z-index: 1000;
    }
    .language-icon {
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transition: all 0.3s;
    }
    .language-icon:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: scale(1.1);
    }
    .language-dropdown {
      position: absolute;
      top: 40px;
      right: 0;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid var(--primary);
      border-radius: 8px;
      padding: 10px 0;
      width: 120px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
      display: none;
      animation: fadeIn 0.3s ease-out;
    }
    .language-dropdown.show {
      display: block;
    }
    .language-option {
      padding: 8px 15px;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.2s;
    }
    .language-option:hover {
      background: rgba(106, 90, 205, 0.2);
    }
    .language-flag {
      width: 20px;
      height: 15px;
      border-radius: 2px;
      display: inline-block;
    }
    .flag-ar {
      background: linear-gradient(to right, #007a3d, #000, #ce1126);
    }
    .flag-en {
      background: linear-gradient(to bottom, #012169 0%, #012169 20%, #ffffff 20%, #ffffff 40%, #c8102e 40%, #c8102e 60%, #ffffff 60%, #ffffff 80%, #012169 80%, #012169 100%);
    }

    .activation-instructions {
      background: rgba(30, 30, 30, 0.95);
      border: 2px solid var(--primary);
      border-radius: 16px;
      padding: 15px;
      margin: 25px auto 0;
      max-width: 400px;
      font-family: 'Cinzel', serif;
      font-size: 0.85rem;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);
    }
    .activation-instructions h3 {
      color: var(--primary);
      text-align: center;
      margin-bottom: 12px;
      font-size: 1.1rem;
      font-weight: 800;
      text-shadow: 0 0 8px rgba(106, 90, 205, 0.5);
    }
    .activation-instructions ul {
      padding-right: 15px;
    }
    .activation-instructions li {
      margin-bottom: 10px;
      line-height: 1.4;
      display: flex;
      align-items: flex-start;
      gap: 8px;
      font-size: 0.8rem;
      font-weight: 700;
      color: #f0f0f0;
    }
    .activation-instructions .warning-icon {
      color: var(--primary);
      font-size: 1rem;
      min-width: 18px;
      text-shadow: 0 0 5px rgba(106, 90, 205, 0.7);
    }

    .no-play {
      color: #ff6b6b !important;
      font-weight: bold;
      animation: pulse 1s infinite;
    }
    #pageGame .language-switcher {
      display: none;
    }

    .promo-title {
      font-family: 'Cinzel', serif;
      font-size: 3rem;
      font-weight: 900;
      color: var(--primary);
      text-shadow: 0 0 15px rgba(106, 90, 205, 0.8);
      margin-bottom: 30px;
      letter-spacing: 5px;
      animation: titleGlow 2s infinite alternate;
      text-align: center;
    }
    @keyframes titleGlow {
      0% { text-shadow: 0 0 15px rgba(106, 90, 205, 0.8); transform: scale(1); }
      100% { text-shadow: 0 0 25px rgba(106, 90, 205, 1), 0 0 40px rgba(106, 90, 205, 0.8); transform: scale(1.05); }
    }
    .leo-title {
      font-family: 'Cinzel', serif;
      font-size: 2.5rem;
      font-weight: 900;
      color: #ff6b6b;
      text-shadow: 0 0 15px rgba(255, 107, 107, 0.8);
      margin-bottom: 10px;
      letter-spacing: 3px;
      animation: leoTitleGlow 2s infinite alternate;
      text-align: center;
    }
    @keyframes leoTitleGlow {
      0% { text-shadow: 0 0 15px rgba(255, 107, 107, 0.8); transform: scale(1); }
      100% { text-shadow: 0 0 25px rgba(255, 107, 107, 1), 0 0 40px rgba(255, 107, 107, 0.8); transform: scale(1.05); }
    }
    .apple-title {
      font-family: 'Pacifico', cursive;
      font-size: 3rem;
      font-weight: 900;
      color: #ff6b6b;
      text-shadow: 0 0 15px rgba(255, 107, 107, 0.8);
      margin-bottom: 30px;
      letter-spacing: 2px;
      animation: appleTitleGlow 2s infinite alternate;
      text-align: center;
      margin-top: 20px;
    }
    @keyframes appleTitleGlow {
      0% { text-shadow: 0 0 15px rgba(255, 107, 107, 0.8); transform: scale(1); }
      100% { text-shadow: 0 0 25px rgba(255, 107, 107, 1), 0 0 40px rgba(255, 107, 107, 0.8); transform: scale(1.05); }
    }
    .loading-spinner {
      display: none;
      width: 30px;
      height: 30px;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .melbet-below-time {
      color: var(--primary);
      font-size: 1.2rem;
      font-weight: 700;
      margin-top: 10px;
      text-align: center;
      text-shadow: 0 0 10px rgba(106, 90, 205, 0.7);
      letter-spacing: 2px;
    }
    .warning-header { text-align: center; margin-bottom: 20px; }
    .warning-title {
      color: var(--primary);
      font-size: 1.8rem;
      font-weight: 700;
      text-shadow: 0 0 10px rgba(106, 90, 205, 0.7);
      margin-bottom: 10px;
    }
    .warning-icon-large {
      font-size: 3rem;
      color: var(--primary);
      margin-bottom: 15px;
      text-shadow: 0 0 15px rgba(106, 90, 205, 0.8);
    }
    .warning-list { margin-bottom: 25px; }
    .warning-item {
      display: flex;
      align-items: flex-start;
      margin-bottom: 15px;
      line-height: 1.5;
    }
    .warning-number {
      background: var(--primary);
      color: #fff;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      margin-left: 10px;
      flex-shrink: 0;
    }
    .warning-text {
      color: #fff;
      font-size: 0.95rem;
      font-weight: 600;
    }
    .warning-highlight {
      color: #ff6b6b;
      font-weight: 700;
    }
    .time-expired-icon {
      font-size: 4.5rem;
      color: #ff6b6b;
      margin-bottom: 20px;
      text-shadow: 0 0 20px rgba(255, 107, 107, 0.7);
      animation: pulse 2s infinite;
    }
    .time-expired-title {
      color: #ff6b6b;
      font-size: 2.2rem;
      font-weight: 900;
      margin-bottom: 15px;
      text-shadow: 0 0 15px rgba(255, 107, 107, 0.5);
      font-family: 'Cinzel', serif;
      letter-spacing: 1px;
    }
    .time-expired-message {
      color: #fff;
      font-size: 1.1rem;
      line-height: 1.6;
      margin-bottom: 25px;
      font-weight: 600;
      text-align: center;
      padding: 0 10px;
    }
    .time-expired-signature {
      color: var(--primary);
      font-size: 1.3rem;
      font-weight: 900;
      margin-top: 15px;
      text-shadow: 0 0 10px rgba(106, 90, 205, 0.7);
      font-family: 'Cinzel', serif;
      letter-spacing: 1px;
    }
    .time-expired-btn {
      background: linear-gradient(to right, #ff6b6b, #ff8e8e);
      color: #1a1a1a;
      margin-top: 20px;
      letter-spacing: 1px;
    }

    @media (max-width: 480px) {
      .overlay { padding: 10px; }
      .game-container { padding: 10px; min-height: auto; margin: 5px auto; }
      .game-title { font-size: 1.8rem; }
      .input-field, .password-field, .activation-input-field { padding: 12px 15px; }
      .btn { padding: 14px; }
      .waiting-title { font-size: 1.5rem; }
      .time-display { font-size: 2rem; }
      .top-info-box { min-width: 110px; height: 45px; padding: 6px 10px; }
      .top-info-value { font-size: 1rem; }
      .top-info-label { font-size: 0.65rem; }
      .user-id-display { min-width: 100px; height: 35px; padding: 5px 8px; }
      .user-id-value { font-size: 0.8rem; }
      .user-id-label { font-size: 0.55rem; }
      .promo-title { font-size: 2.2rem; letter-spacing: 3px; }
      .leo-title { font-size: 1.8rem; letter-spacing: 2px; }
      .activation-instructions { padding: 12px; max-width: 350px; font-size: 0.8rem; }
      .activation-instructions h3 { font-size: 1rem; }
      .activation-instructions li { font-size: 0.75rem; }
      .waiting-user-id { min-width: 110px; padding: 5px 10px; }
      .waiting-user-id-value { font-size: 0.85rem; }
      .melbet-warning { padding: 10px 12px; max-width: 340px; }
      .melbet-text { font-size: 0.9rem; }
      .waiting-message { font-size: 0.85rem; padding: 10px; }
      .warning-content { padding: 20px; max-width: 350px; }
      .warning-title { font-size: 1.5rem; }
      .warning-icon-large { font-size: 2.5rem; }
      .warning-text { font-size: 0.9rem; }
      .time-expired-content { padding: 25px 20px; max-width: 340px; }
      .time-expired-icon { font-size: 3.5rem; }
      .time-expired-title { font-size: 1.8rem; }
      .time-expired-message { font-size: 1rem; }
      .time-expired-highlight { font-size: 1.1rem; }
      .time-expired-signature { font-size: 1.1rem; }
      .instructions-icon { width: 40px; height: 40px; font-size: 1.2rem; margin: 15px auto 25px; }
      .instructions-content { padding: 20px; max-width: 350px; }
      .images-rectangle { padding: 8px; }
      .image-cell { width: 32px; height: 32px; }
      .controls, .game-controls-external { gap: 10px; }
      .control-btn { padding: 10px; font-size: 0.9rem; }
      .multipliers { height: 200px; margin-right: 6px; }
      .multiplier { font-size: 0.85rem; height: 30px; }
      .apple-title { font-size: 2.5rem; }
      .code-display { font-size: 1.2rem; padding: 5px 10px; }
      .password-field { padding: 10px 12px; font-size: 0.9rem; }
      .activate-btn { padding: 10px 15px; font-size: 0.9rem; }
      .ok-btn { width: 50%; padding: 10px; font-size: 1rem; }
      .activation-input-field { padding: 12px 15px; font-size: 1rem; }
      .melbet-below-time { font-size: 1rem; }
      .telegram-icon { width: 32px; height: 32px; font-size: 1.1rem; }
    }
  </style>
</head>
<body>
  <div class="mobile-frame">
    <div class="background-main"></div>
    <div class="background-image"></div>
    <div class="background-overlay"></div>
    <div class="background-game"></div>
    <div class="overlay">
      <div id="pageRegistration" class="page active">
        <div class="language-switcher" id="languageSwitcher">
          <div class="language-icon"><i class="fas fa-globe"></i></div>
          <div class="language-dropdown" id="languageDropdown">
            <div class="language-option" data-lang="ar">
              <span class="language-flag flag-ar"></span>
              <span class="language-name">العربية</span>
            </div>
            <div class="language-option" data-lang="en">
              <span class="language-flag flag-en"></span>
              <span class="language-name">English</span>
            </div>
          </div>
        </div>
        <div class="page-bottom-content">
          <div class="apple-title">Apple Of Fortune</div>
          <div class="form-container">
            <div class="input-group">
              <label class="input-label" id="regIdLabel">ID</label>
              <input type="text" class="input-field" placeholder="ID" maxlength="10"
                     oninput="this.value = this.value.replace(/[^0-9]/g, '')" inputmode="numeric" id="playerIdInput">
            </div>
            <div class="password-group">
              <input type="text" class="password-field" placeholder="T7788" id="passwordInput" autocomplete="off">
              <button class="activate-btn" id="regStartBtn"><span id="startGameText">Activate</span></button>
            </div>
          </div>
          <div class="instructions-icon" id="instructionsIcon"><i class="fas fa-question"></i></div>
        </div>
      </div>

      <div id="pageActivation" class="page">
        <div class="language-switcher">
          <div class="language-icon"><i class="fas fa-globe"></i></div>
        </div>
        <div class="page-bottom-content">
          <div class="form-container">
            <div class="leo-title">LEO</div>
            <h1 class="promo-title">T 7 7 8 8</h1>
            <input type="text" class="activation-input-field" placeholder="أدخل كود التفعيل" id="activationInput" autocomplete="off">
            <button class="ok-btn" id="doneBtn"><span id="activateAccountText">OK</span></button>
          </div>
          <div class="activation-instructions">
            <h3><i class="fas fa-key"></i> <span id="activationInfoTitle">معلومات التفعيل</span></h3>
            <ul>
              <li><i class="fas fa-exclamation-triangle warning-icon"></i> <span id="activationInfo1">يجب الحصول علي كود التفعيل من المطور LEO</span></li>
              <li><i class="fas fa-exclamation-triangle warning-icon"></i> <span id="activationInfo2">تحذير: الحسابات الغير مفعلة بالكود لا تعمل بشكل صحيح</span></li>
            </ul>
          </div>
        </div>
      </div>

      <div id="pageWaiting" class="page">
        <div class="language-switcher">
          <div class="language-icon"><i class="fas fa-globe"></i></div>
        </div>
        <div class="waiting-page">
          <div class="waiting-container">
            <div class="waiting-user-id">
              <div class="waiting-user-id-label">ID</div>
              <div class="waiting-user-id-value" id="waitingUserIdDisplay">0000000000</div>
            </div>
            <div class="waiting-header">
              <div class="waiting-title" id="connectingText">جاري الاتصال بالخوادم...</div>
            </div>
            <div class="time-container">
              <div class="time-display" id="timeValue">00:30</div>
              <div class="time-label" id="remainingText">متبقي</div>
              <div class="melbet-below-time">M E L B E T</div>
            </div>
            <div class="progress-container">
              <div class="progress-bar" id="progressBar"></div>
            </div>
            <div class="steps-container">
              <div class="steps-line"></div>
              <div class="step active">
                <div class="step-icon"><i class="fas fa-check"></i></div>
                <div class="step-text" id="step1Text">تم التفعيل</div>
              </div>
              <div class="step">
                <div class="step-icon"><i class="fas fa-sync-alt"></i></div>
                <div class="step-text" id="step2Text">يتم الاتصال</div>
              </div>
              <div class="step">
                <div class="step-icon"><i class="fas fa-download"></i></div>
                <div class="step-text" id="step3Text">تجهيز التوقعات</div>
              </div>
              <div class="step">
                <div class="step-icon"><i class="fas fa-check-circle"></i></div>
                <div class="step-text" id="step4Text">جاهز</div>
              </div>
            </div>
            <div class="melbet-warning">
              <div class="melbet-text">
                <i class="fas fa-exclamation-circle"></i> تحذير: هذا السرفير يعمل علي MELBET فقط استمتع معنا بمغامرة ممتعة
              </div>
            </div>
            <div class="waiting-message">
              <i class="fas fa-info-circle"></i>
              <span id="waitingInfoText">جاري الاتصال بالخوادم الرئيسية والكشف عن الثغرات الرجاء عدم إغلاق التطبيق.</span>
            </div>
          </div>
        </div>
      </div>

      <!-- صفحة اللعبة: التخطيط الجديد -->
      <div id="pageGame" class="page">
        <div class="game-top-section">
          <div class="user-id-display">
            <div class="user-id-label">ID</div>
            <div class="user-id-value" id="userIDDisplay">0000000000</div>
          </div>
          <div class="top-info-boxes">
            <div class="top-info-box">
              <div class="top-info-value" id="countdownTimer">01:00:00</div>
              <div class="top-info-label">TIME</div>
            </div>
            <div class="top-info-box">
              <div class="top-info-value" id="onlineCount">1500</div>
              <div class="top-info-label">ONLINE</div>
            </div>
          </div>
        </div>

        <div class="game-middle-section">
          <!-- نص LEO ALGORITHMS -->
          <div class="algorithms-title">LEO ALGORITHMS</div>
          <div class="images-rectangle">
            <div class="images-grid-container">
              <div class="multipliers">
                <div class="multiplier">×6.71</div>
                <div class="multiplier">×4.02</div>
                <div class="multiplier">×2.41</div>
                <div class="multiplier">×1.93</div>
                <div class="multiplier">×1.54</div>
                <div class="multiplier">×1.23</div>
              </div>
              <div class="images-grid" id="imagesGrid"></div>
            </div>
          </div>
        </div>

        <div class="game-bottom-section">
          <div class="game-controls-external">
            <button class="control-btn start-btn" id="gameStartBtn">
              <i class="fas fa-play"></i> <span id="startText">Start</span>
            </button>
            <button class="control-btn restart-btn" id="restartBtn">
              <i class="fas fa-redo"></i> <span id="restartText">Restart</span>
            </button>
          </div>
          <div class="code-display">CODE : T 7 7 8 8</div>
          <div class="telegram-link">
            <a href="https://t.me/Leo_Official_0" target="_blank" class="telegram-icon">
              <i class="fab fa-telegram-plane"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- نافذة تفعيل الحساب -->
  <div id="activationModal" class="activation-modal" style="display: none;">
    <div class="activation-content">
      <div class="activation-text" id="activationText">أنتظر...</div>
    </div>
  </div>

  <!-- Modals -->
  <div id="warningModal" class="warning-modal" style="display: none;">
    <div class="warning-content">
      <div class="warning-header">
        <div class="warning-icon-large"><i class="fas fa-exclamation-triangle"></i></div>
        <div class="warning-title" id="warningTitle">تحذير هام</div>
      </div>
      <div class="warning-list">
        <div class="warning-item">
          <div class="warning-number">1</div>
          <div class="warning-text" id="warningItem1">تاكد بأنك فعلت الشروط بشكل صحيح لكي تتمكن من الحصول علي افضل نتيجة من الخورزميات المشفرة</div>
        </div>
      </div>
      <button class="warning-btn" id="understandBtn">
        <i class="fas fa-check-circle"></i> <span id="understandBtnText">فهمت</span>
      </button>
    </div>
  </div>

  <div id="timeExpiredModal" class="time-expired-modal" style="display: none;">
    <div class="time-expired-content">
      <div class="time-expired-icon"><i class="fas fa-hourglass-end"></i></div>
      <div class="time-expired-title" id="timeExpiredTitle">انتهى الوقت!</div>
      <div class="time-expired-message" id="timeExpiredMessage">لقد قمت بالانتهاء من الفترة المحددة لك وسوف يتم تعطيل السرفير من الان</div>
      <div class="time-expired-signature">مع تحيات <span class="time-expired-highlight">MR $ LEO</span></div>
      <button class="time-expired-btn" id="timeExpiredBtn">
        <i class="fas fa-times-circle"></i> <span id="timeExpiredBtnText">إغلاق</span>
      </button>
    </div>
  </div>

  <div id="instructionsModal" class="instructions-modal" style="display: none;">
    <div class="instructions-content">
      <button class="instructions-close" id="instructionsClose"><i class="fas fa-times"></i></button>
      <div class="instructions">
        <h3><i class="fas fa-info-circle"></i> <span id="instructionsTitleModal">التعليمات</span></h3>
        <ul>
          <li><i class="fas fa-exclamation-triangle warning-icon"></i> <span id="instruction1Modal">يجب التسجيل باستخدام الكود الصحيح T7788</span></li>
          <li><i class="fas fa-exclamation-triangle warning-icon"></i> <span id="instruction2Modal">ادخل رقم معرف حسابك المسجل بالكود T7788</span></li>
          <li><i class="fas fa-exclamation-triangle warning-icon"></i> <span id="instruction3Modal">التوقعات تعمل بنسبة نجاح 95%</span></li>
        </ul>
        <div class="instructions-signature">LEO HACK PRO</div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelector('.mobile-frame').style.display = 'block';
      buildImageCells();
    });

    const gameState = {
      currentLanguage: 'ar',
      countdownSeconds: 3600,
      onlineUsers: 1500,
      countdownInterval: null,
      onlineInterval: null,
      currentRow: 5, // نبدأ من الصف 5 (0 إلى 5 = 6 صفوف)
      currentRevealedCell: null
    };

    const translations = {
      ar: {
        regIdLabel: 'ID',
        startGameText: 'Activate',
        instructionsTitleModal: 'التعليمات',
        instruction1Modal: 'يجب التسجيل باستخدام الكود الصحيح T7788',
        instruction2Modal: 'ادخل رقم معرف حسابك المسجل بالكود T7788',
        instruction3Modal: 'التوقعات تعمل بنسبة نجاح 95%',
        activationInfoTitle: 'معلومات التفعيل',
        activationInfo1: 'يجب الحصول علي كود التفعيل من المطور LEO',
        activationInfo2: 'تحذير: الحسابات الغير مفعلة بالكود لا تعمل بشكل صحيح',
        connectingText: 'جاري الاتصال بالخوادم...',
        remainingText: 'متبقي',
        step1Text: 'تم التفعيل',
        step2Text: 'يتم الاتصال',
        step3Text: 'تجهيز التوقعات',
        step4Text: 'جاهز',
        waitingInfoText: 'جاري الاتصال بالخوادم الرئيسية والكشف عن الثغرات الرجاء عدم إغلاق التطبيق.',
        startText: 'Start',
        restartText: 'Restart',
        activateAccountText: 'OK',
        warningTitle: 'تحذير هام',
        warningItem1: 'تاكد بأنك فعلت الشروط بشكل صحيح لكي تتمكن من الحصول علي افضل نتيجة من الخورزميات المشفرة',
        understandBtnText: 'فهمت',
        timeExpiredTitle: 'انتهى الوقت!',
        timeExpiredMessage: 'لقد قمت بالانتهاء من الفترة المحددة لك وسوف يتم تعطيل السرفير من الان',
        timeExpiredBtnText: 'إغلاق'
      },
      en: {
        regIdLabel: 'ID',
        startGameText: 'Activate',
        instructionsTitleModal: 'Instructions',
        instruction1Modal: 'You must register with the correct code T7788',
        instruction2Modal: 'Enter your account ID registered with code T7788',
        instruction3Modal: 'Predictions work with 95% success rate',
        activationInfoTitle: 'Activation Info',
        activationInfo1: 'You must obtain the activation code from developer LEO',
        activationInfo2: 'Warning: Accounts not activated with code will not work properly',
        connectingText: 'Connecting to servers...',
        remainingText: 'remaining',
        step1Text: 'Activated',
        step2Text: 'Connecting',
        step3Text: 'Preparing predictions',
        step4Text: 'Ready',
        waitingInfoText: 'Connecting to main servers. Please do not close the application.',
        startText: 'Start',
        restartText: 'Restart',
        activateAccountText: 'OK',
        warningTitle: 'Important Warning',
        warningItem1: 'Make sure you have correctly fulfilled all conditions to get the best results from the encrypted algorithms.',
        understandBtnText: 'Understood',
        timeExpiredTitle: 'Time Expired!',
        timeExpiredMessage: 'Your session has ended. The server will be disabled now.',
        timeExpiredBtnText: 'Close'
      }
    };

    const showAlert = (key) => {
      const lang = gameState.currentLanguage;
      const msg = {
        invalidId: { ar: '❗ يجب أن يتكون الـ ID من أرقام فقط', en: '❗ ID must contain only numbers' },
        shortId: { ar: '❗ يجب أن يتكون الـ ID من 10 أرقام على الأقل', en: '❗ ID must be at least 10 digits' },
        wrongPassword: { ar: '❗ كلمة المرور غير صحيحة. يجب إدخال T7788', en: '❗ Incorrect password. Please enter T7788' },
        invalidCode: { ar: '❗ كود التفعيل غير صحيح', en: '❗ Invalid activation code!' }
      }[key]?.[lang] || '❗ Error';
      alert(msg);
    };

    const changeLanguage = (lang) => {
      gameState.currentLanguage = lang;
      document.documentElement.lang = lang;
      document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
      const langData = translations[lang];
      Object.keys(langData).forEach(key => {
        const el = document.getElementById(key);
        if (el) el.textContent = langData[key];
      });
      localStorage.setItem('selectedLanguage', lang);
    };

    const showPage = (pageId) => {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(pageId).classList.add('active');
      const bgMain = document.querySelector('.background-main');
      const bgImg = document.querySelector('.background-image');
      const bgOverlay = document.querySelector('.background-overlay');
      const bgGame = document.querySelector('.background-game');
      if (pageId === 'pageGame') {
        bgMain.style.display = 'none';
        bgImg.style.display = 'none';
        bgOverlay.style.display = 'none';
        bgGame.style.display = 'block';
        document.getElementById('userIDDisplay').textContent = document.getElementById('playerIdInput').value;
        startCountdown();
        startOnlineUsersUpdate();
      } else if (pageId === 'pageWaiting') {
        bgMain.style.display = 'block';
        bgImg.style.display = 'block';
        bgOverlay.style.display = 'block';
        bgGame.style.display = 'none';
        document.getElementById('waitingUserIdDisplay').textContent = document.getElementById('playerIdInput').value;
      } else {
        bgMain.style.display = 'block';
        bgImg.style.display = 'block';
        bgOverlay.style.display = 'block';
        bgGame.style.display = 'none';
        stopCountdown();
        stopOnlineUsersUpdate();
      }
    };

    const buildImageCells = () => {
      const grid = document.getElementById('imagesGrid');
      grid.innerHTML = '';
      const imgUrl = 'https://c.top4top.io/p_3582ax4oj1.jpg';
      for (let row = 0; row < 6; row++) {
        for (let col = 0; col < 5; col++) {
          const cell = document.createElement('div');
          cell.className = 'image-cell';
          cell.dataset.row = row;
          cell.dataset.col = col;
          cell.dataset.index = row * 5 + col;
          const img = document.createElement('img');
          img.src = imgUrl;
          cell.appendChild(img);
          grid.appendChild(cell);
        }
      }
    };

    // === دالة الكشف الأصلية ===
    const revealRandomImage = () => {
      // إذا وصلنا للصف الأعلى (أقل من 0)، نوقف
      if (gameState.currentRow < 0) {
        document.getElementById('startText').textContent = 'Stop';
        return;
      }

      // إزالة الكشف عن الخلية السابقة (إن وُجدت)
      if (gameState.currentRevealedCell !== null) {
        const prev = document.querySelector(`.image-cell[data-index="${gameState.currentRevealedCell}"]`);
        if (prev) prev.classList.remove('revealed');
      }

      // الحصول على جميع الخلايا في **الصف الحالي**
      const cellsInCurrentRow = document.querySelectorAll(`.image-cell[data-row="${gameState.currentRow}"]`);
      // اختيار خلية عشوائية من الصف الحالي
      const randomIndex = Math.floor(Math.random() * cellsInCurrentRow.length);
      const randomCell = cellsInCurrentRow[randomIndex];

      // كشف الصورة
      randomCell.classList.add('revealed');
      const cellIndex = parseInt(randomCell.dataset.index);
      gameState.currentRevealedCell = cellIndex;

      // الانتقال للصف الأعلى (0 -> 1 -> 2 -> ... -> 5)
      gameState.currentRow--;
    };

    // === دالة إعادة التعيين ===
    const resetAllImages = () => {
      document.querySelectorAll('.image-cell').forEach(c => c.classList.remove('revealed'));
      gameState.currentRevealedCell = null;
      gameState.currentRow = 5; // نبدأ من الصف الأخير (0 إلى 5 = 6 صفوف)
      document.getElementById('startText').textContent = 'Start';
    };

    const startCountdown = () => {
      gameState.countdownSeconds = 3600;
      updateCountdown();
      if (gameState.countdownInterval) clearInterval(gameState.countdownInterval);
      gameState.countdownInterval = setInterval(() => {
        gameState.countdownSeconds--;
        updateCountdown();
        if (gameState.countdownSeconds <= 0) {
          clearInterval(gameState.countdownInterval);
          const timerEl = document.getElementById('countdownTimer');
          timerEl.textContent = 'NO PLAY';
          timerEl.classList.add('no-play');
          document.getElementById('timeExpiredModal').style.display = 'flex';
        }
      }, 1000);
    };

    const updateCountdown = () => {
      const h = Math.floor(gameState.countdownSeconds / 3600);
      const m = Math.floor((gameState.countdownSeconds % 3600) / 60);
      const s = gameState.countdownSeconds % 60;
      document.getElementById('countdownTimer').textContent =
        `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
    };

    const stopCountdown = () => {
      if (gameState.countdownInterval) {
        clearInterval(gameState.countdownInterval);
        gameState.countdownInterval = null;
      }
    };

    const startOnlineUsersUpdate = () => {
      if (gameState.onlineInterval) clearInterval(gameState.onlineInterval);
      gameState.onlineInterval = setInterval(() => {
        const change = Math.floor(Math.random() * 100) - 45;
        gameState.onlineUsers += change;
        if (gameState.onlineUsers < 500) gameState.onlineUsers = 500;
        if (gameState.onlineUsers > 3000) gameState.onlineUsers = 3000;
        document.getElementById('onlineCount').textContent = gameState.onlineUsers;
      }, 3000);
    };

    const stopOnlineUsersUpdate = () => {
      if (gameState.onlineInterval) {
        clearInterval(gameState.onlineInterval);
        gameState.onlineInterval = null;
      }
    };

    // Event Listeners
    document.getElementById('regStartBtn').addEventListener('click', () => {
      const id = document.getElementById('playerIdInput').value;
      const pwd = document.getElementById('passwordInput').value.trim();
      if (!/^\d+$/.test(id)) return showAlert('invalidId');
      if (id.length < 10) return showAlert('shortId');
      if (pwd !== 'T7788') return showAlert('wrongPassword');
      // === عرض نافذة التفعيل ===
      const modal = document.getElementById('activationModal');
      const textEl = document.getElementById('activationText');
      textEl.textContent = 'أنتظر...';
      modal.style.display = 'flex';
      setTimeout(() => {
        textEl.textContent = 'تم التنشيط';
        setTimeout(() => {
          modal.style.display = 'none';
          showPage('pageActivation');
        }, 1000);
      }, 3000);
    });

    document.getElementById('doneBtn').addEventListener('click', () => {
      const code = document.getElementById('activationInput').value.trim();
      const valid = ["DNSx_78YG_sjSJ_1", "kjS9_SHAb_89JK_2", "2Nks_sj8g_JNAI_3"];
      if (valid.includes(code)) {
        document.getElementById('warningModal').style.display = 'flex';
      } else {
        showAlert('invalidCode');
      }
    });

    document.getElementById('gameStartBtn').addEventListener('click', revealRandomImage);
    document.getElementById('restartBtn').addEventListener('click', resetAllImages);
    document.getElementById('understandBtn').addEventListener('click', () => {
      document.getElementById('warningModal').style.display = 'none';
      showPage('pageWaiting');
      let timeLeft = 30;
      const timer = setInterval(() => {
        const m = Math.floor(timeLeft / 60);
        const s = timeLeft % 60;
        document.getElementById('timeValue').textContent = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        document.getElementById('progressBar').style.width = `${((30 - timeLeft) / 30) * 100}%`;
        if (timeLeft <= 22) document.querySelectorAll('.step')[1].classList.add('active');
        if (timeLeft <= 13) document.querySelectorAll('.step')[2].classList.add('active');
        if (timeLeft <= 4) document.querySelectorAll('.step')[3].classList.add('active');
        timeLeft--;
        if (timeLeft < 0) {
          clearInterval(timer);
          showPage('pageGame');
        }
      }, 1000);
    });
    document.getElementById('timeExpiredBtn').addEventListener('click', () => {
      document.getElementById('timeExpiredModal').style.display = 'none';
    });
    document.getElementById('instructionsIcon').addEventListener('click', () => {
      document.getElementById('instructionsModal').style.display = 'flex';
    });
    document.getElementById('instructionsClose').addEventListener('click', () => {
      document.getElementById('instructionsModal').style.display = 'none';
    });
    document.getElementById('instructionsModal').addEventListener('click', e => {
      if (e.target === e.currentTarget) e.currentTarget.style.display = 'none';
    });

    document.querySelectorAll('.language-option').forEach(opt => {
      opt.addEventListener('click', () => {
        changeLanguage(opt.dataset.lang);
        document.getElementById('languageDropdown').classList.remove('show');
      });
    });

    document.getElementById('languageSwitcher').addEventListener('click', e => {
      e.stopPropagation();
      document.getElementById('languageDropdown').classList.toggle('show');
    });

    document.addEventListener('click', e => {
      if (!document.getElementById('languageSwitcher').contains(e.target)) {
        document.getElementById('languageDropdown').classList.remove('show');
      }
    });

    const savedLang = localStorage.getItem('selectedLanguage') || 'ar';
    changeLanguage(savedLang);
  </script>
</body>
</html>